input {
  file {
    path => "/Users/shin/elk/webinar/20201118/data.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
  }
}

filter {
  csv {
    columns => ["transaction_date","price","product","user_id"]
  }

  date {
    match => ["transaction_date", "yyyy-MM-dd HH:mm:ss"]
    target => "date"
    timezone => 'Asia/Seoul'
  }

  mutate {
    remove_field => [ "message", "host" ]
  }
}

output {
  stdout {}
  elasticsearch {
    hosts => ["localhost:9200"]
    index => "sales"
  }
#  elasticsearch {
#    cloud_id => ["i-o-optimized-deployment:YXNpYS1ub3J0aGVhc3QxLmdjcC5jbG91ZC5lcy5pbyQ2OGM4NDRlOTk0ZDE0NWI3YWE0YzAxYTRjNmViM2E2ZiRlYThkZTBmMDIzOTg0NzkwYTZkZDdiODM4OGVmZTQ1Mg=="]
#    cloud_auth => "elastic:I5hHmjLnfcSGfffwIgBeAa2l"
#    index => "sales_new"
#  }
}
